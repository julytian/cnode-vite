import{r as e,Y as t,Z as a,$ as i,a0 as n,B as u,K as o,E as r,D as l,i as c,j as v,a1 as s,a2 as f,H as d,g as h,l as p,a3 as g,a4 as w,a5 as m,M as y,C as b}from"./index.8a704415.js";import{u as S,r as C,a as x}from"./useChildren.92f02d8d.js";function z(){var i=e(t?window.innerWidth:0),n=e(t?window.innerHeight:0),u=function(){i.value=window.innerWidth,n.value=window.innerHeight};return a("resize",u),a("orientationchange",u),{width:i,height:n}}function M(e){var t=e.interceptor,a=e.args,u=e.done,o=e.canceled;if(t){var r=t.apply(null,a||[]);i(r)?r.then((function(e){e?u():o&&o()})).catch(n):r?u():o&&o()}else u()}var B=p("swipe"),T=B[0],N=B[1],Y=T({props:{width:[Number,String],height:[Number,String],autoplay:[Number,String],vertical:Boolean,lazyRender:Boolean,indicatorColor:String,loop:{type:Boolean,default:!0},duration:{type:[Number,String],default:500},touchable:{type:Boolean,default:!0},initialSwipe:{type:[Number,String],default:0},showIndicators:{type:Boolean,default:!0},stopPropagation:{type:Boolean,default:!0}},emits:["change"],setup:function(i,n){var p,b,x,M,B=n.emit,T=n.slots,Y=e(),D=u({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),I=o(),O=z(),X=S("vanSwipe"),j=X.children,k=X.linkChildren,H=r((function(){return j.length})),A=r((function(){return D[i.vertical?"height":"width"]})),E=r((function(){return i.vertical?I.deltaY.value:I.deltaX.value})),P=r((function(){return(i.vertical?D.rect.height:D.rect.width)-A.value*H.value})),R=r((function(){return Math.ceil(Math.abs(P.value)/A.value)})),W=r((function(){return H.value*A.value})),K=r((function(){return(D.active+H.value)%H.value})),Z=r((function(){var e=i.vertical?"vertical":"horizontal";return I.direction.value===e})),$=r((function(){var e=i.vertical?"height":"width",t=i.vertical?"width":"height",a={transitionDuration:(D.swiping?0:i.duration)+"ms",transform:"translate"+(i.vertical?"Y":"X")+"("+D.offset+"px)"};return A.value&&(a[e]=W.value+"px",a[t]=i[t]?i[t]+"px":""),a})),q=function(e,t){void 0===t&&(t=0);var a=e*A.value;i.loop||(a=Math.min(a,-P.value));var n=t-a;return i.loop||(n=C(n,P.value,0)),n},F=function(e){var t=e.pace,a=void 0===t?0:t,n=e.offset,u=void 0===n?0:n,o=e.emitChange;if(!(H.value<=1)){var r=D.active,l=function(e){var t=D.active;return e?i.loop?C(t+e,-1,H.value):C(t+e,0,R.value):t}(a),c=q(l,u);if(i.loop){if(j[0]&&c!==P.value){var v=c<P.value;j[0].setOffset(v?W.value:0)}if(j[H.value-1]&&0!==c){var s=c>0;j[H.value-1].setOffset(s?-W.value:0)}}D.active=l,D.offset=c,o&&l!==r&&B("change",K.value)}},G=function(){D.swiping=!0,D.active<=-1&&F({pace:H.value}),D.active>=H.value&&F({pace:-H.value})},J=function(){G(),I.reset(),g((function(){D.swiping=!1,F({pace:1,emitChange:!0})}))},L=function(){clearTimeout(p)},Q=function e(){i.autoplay>0&&H.value>1&&(L(),p=setTimeout((function(){J(),e()}),i.autoplay))},U=function(e){if(void 0===e&&(e=+i.initialSwipe),Y.value&&!w(Y)){L();var t=m(Y);D.rect=t,D.swiping=!0,D.active=e,D.width=+i.width||t.width,D.height=+i.height||t.height,D.offset=q(e),j.forEach((function(e){e.setOffset(0)})),Q()}},V=function(){U(D.active)},_=function(e){i.touchable&&(I.start(e),b=Date.now(),L(),G())},ee=function(e){i.touchable&&D.swiping&&(I.move(e),Z.value&&(y(e,i.stopPropagation),F({offset:E.value})))},te=function(){if(i.touchable&&D.swiping){var e=Date.now()-b,t=E.value/e;if((Math.abs(t)>.25||Math.abs(E.value)>A.value/2)&&Z.value){var a=i.vertical?I.offsetY.value:I.offsetX.value,n=0;n=i.loop?a>0?E.value>0?-1:1:0:-Math[E.value>0?"ceil":"floor"](E.value/A.value),F({pace:n,emitChange:!0})}else E.value&&F({pace:0});D.swiping=!1,Q()}},ae=function(e,t){var a=t===K.value,n=a?{backgroundColor:i.indicatorColor}:null;return h("i",{style:n,class:N("indicator",{active:a})},null)};return l({prev:function(){G(),I.reset(),g((function(){D.swiping=!1,F({pace:-1,emitChange:!0})}))},next:J,state:D,resize:V,swipeTo:function(e,t){void 0===t&&(t={}),G(),I.reset(),g((function(){var a;a=i.loop&&e===H.value?0===D.active?0:e:e%H.value,t.immediate?g((function(){D.swiping=!1})):D.swiping=!1,F({pace:a-D.active,emitChange:!0})}))}}),k({size:A,props:i,count:H,activeIndicator:K}),c((function(){return i.initialSwipe}),U),c((function(){return j.length}),(function(){var e=Math.min(j.length-1,D.active);U(e)})),c((function(){return i.autoplay}),(function(e){e>0?Q():L()})),c([O.width,O.height],V),c((x=e("visible"),(M=function(){t&&(x.value=document.hidden?"hidden":"visible")})(),a("visibilitychange",M),x),(function(e){"visible"===e?Q():L()})),v(U),s((function(){U(D.active)})),f(L),d(L),function(){return h("div",{ref:Y,class:N()},[h("div",{style:$.value,class:N("track",{vertical:i.vertical}),onTouchstart:_,onTouchmove:ee,onTouchend:te,onTouchcancel:te},[null==T.default?void 0:T.default()]),T.indicator?T.indicator():i.showIndicators&&H.value>1?h("div",{class:N("indicators",{vertical:i.vertical})},[Array.apply(void 0,Array(H.value)).map(ae)]):void 0])}}}),D=p("swipe-item"),I=D[0],O=D[1],X=I({setup:function(e,t){var a,i=t.slots,n=u({offset:0,inited:!1,mounted:!1}),o=x("vanSwipe"),c=o.parent,s=o.index,f=r((function(){var e={},t=c.props.vertical;return c.size.value&&(e[t?"height":"width"]=c.size.value+"px"),n.offset&&(e.transform="translate"+(t?"Y":"X")+"("+n.offset+"px)"),e})),d=r((function(){var e=c.props,t=e.loop;if(!e.lazyRender||a)return!0;if(!n.mounted)return!1;var i=c.activeIndicator.value,u=c.count.value-1,o=0===i&&t?u:i-1,r=i===u&&t?0:i+1;return a=s.value===i||s.value===o||s.value===r}));return v((function(){b((function(){n.mounted=!0}))})),l({setOffset:function(e){n.offset=e}}),function(){return h("div",{class:O(),style:f.value},[d.value?null==i.default?void 0:i.default():null])}}});export{X as S,Y as a,M as c,z as u};
