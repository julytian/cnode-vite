import{z as e,d as a,O as s,p as t,c as n,e as m,J as i,o as r,f as d,g as c,w as o,R as l,Q as g,h as p,_,r as u,b as v,j as h,F as y,a8 as f}from"./index.4ac44177.js";import{T as k,a as b,E as x}from"./index.ac4b29de.js";import"./index.1c780af1.js";import"./useChildren.13696e91.js";import"./use-route.8d11ccb6.js";var j=a({name:"MessageItem",props:{item:{type:Object,default:{},required:!0}},methods:{getLastTimeStr:(e,a)=>s(e,a)}});const T=p("data-v-69124f45");t("data-v-69124f45");const I={class:"message markdown-body"},M={class:"d-flex"},w={class:"message-hd-avatar"},L={class:"flex-1 message-hd-title"},N={key:0},C={key:1},H={class:"message-topic"};n();const z=T(((e,a,s,t,n,p)=>{const _=m("router-link"),u=i("lazy");return r(),d("section",I,[c("div",M,[o(c("img",w,null,512),[[u,e.item.author.avatar_url]]),c("p",L,[c("span",null,l(e.item.author.loginname),1),"at"===e.item.type?(r(),d("span",N,"在回复中@了您")):g("",!0),"reply"===e.item.type?(r(),d("span",C,"回复了您的话题")):g("",!0)]),c("span",{class:"message-hd-time",textContent:l(e.getLastTimeStr(e.item.reply.create_at,!0))},null,8,["textContent"])]),c("div",{class:"message-reply",innerHTML:e.item.reply.content},null,8,["innerHTML"]),c(_,{to:{name:"Topic",params:{id:e.item.topic.id}}},{default:T((()=>[c("div",H,"话题："+l(e.item.topic.title),1)])),_:1},8,["to"])])}));j.render=z,j.__scopeId="data-v-69124f45";var O=a({name:"MessagePage",components:{[k.name]:k,[b.name]:b,[x.name]:x,NavHeader:_,MessageItem:j},setup(){const a=u({}),s=u("has_read_messages"),t=v(),{token:n}=t.state.user.userInfo;return h((async()=>{try{const t=await(s=n,e.get(`/messages?accesstoken=${s}`));a.value=t}catch(t){}var s})),{message:a,activeName:s}}});const S=p("data-v-c9afc390"),q=S(((e,a,s,t,n,i)=>{const o=m("nav-header"),l=m("van-empty"),g=m("message-item"),p=m("van-tab"),_=m("van-tabs");return r(),d(y,null,[c(o,{title:"消息"}),c(_,{active:e.activeName,"onUpdate:active":a[1]||(a[1]=a=>e.activeName=a),swipeable:"",sticky:""},{default:S((()=>[c(p,{title:"已读消息",name:"has_read_messages"},{default:S((()=>[e.message.has_read_messages&&0===e.message.has_read_messages.length?(r(),d(l,{key:0,description:"暂无数据"})):(r(!0),d(y,{key:1},f(e.message.has_read_messages,(e=>(r(),d(g,{key:e.id,item:e},null,8,["item"])))),128))])),_:1}),c(p,{title:"未读消息",name:"hasnot_read_messages"},{default:S((()=>[e.message.hasnot_read_messages&&0===e.message.hasnot_read_messages.length?(r(),d(l,{key:0,description:"暂无数据"})):(r(!0),d(y,{key:1},f(e.message.hasnot_read_messages,(e=>(r(),d(g,{key:e.id,item:e},null,8,["item"])))),128))])),_:1})])),_:1},8,["active"])],64)}));O.render=q,O.__scopeId="data-v-c9afc390";export default O;
