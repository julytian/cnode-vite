import{Y as e,Z as t,aq as n,s as a,g as l,l as o,n as r,I as i,B as u,r as s,E as c,D as d,a7 as f,i as p,j as v,C as m,M as g,G as b,t as h,m as y,q as w,ar as x,$ as k,as as C,at as S,au as V,af as P,a5 as B,w as z,an as M,P as O,av as I,z as j,d as F,_ as T,b as A,a as N,p as W,c as q,e as D,o as L,f as E,F as H,h as U}from"./index.e500129b.js";import{a as _,f as R,u as $}from"./useChildren.fd7a9bfd.js";import{a as G,u as K}from"./use-route.e9ee84c7.js";import{T as Y}from"./index.1e66091d.js";import"./mount-component.419c28af.js";var Z=o("cell"),J=Z[0],Q=Z[1],X={icon:String,size:String,title:[Number,String],value:[Number,String],label:[Number,String],center:Boolean,isLink:Boolean,required:Boolean,iconPrefix:String,titleStyle:null,titleClass:null,valueClass:null,labelClass:null,arrowDirection:String,border:{type:Boolean,default:!0},clickable:{type:Boolean,default:null}},ee=J({props:a({},X,G),setup:function(e,t){var n=t.slots,a=K(),o=function(){if(n.label||r(e.label))return l("div",{class:[Q("label"),e.labelClass]},[n.label?n.label():e.label])},u=function(){if(n.title||r(e.title))return l("div",{class:[Q("title"),e.titleClass],style:e.titleStyle},[n.title?n.title():l("span",null,[e.title]),o()])},s=function(){var t=n.title||r(e.title);if(n.default||r(e.value))return l("div",{class:[Q("value",{alone:!t}),e.valueClass]},[n.default?n.default():l("span",null,[e.value])])},c=function(){if(n["right-icon"])return n["right-icon"]();if(e.isLink){var t=e.arrowDirection?"arrow-"+e.arrowDirection:"arrow";return l(i,{name:t,class:Q("right-icon")},null)}};return function(){var t,o=e.size,r=e.center,d=e.border,f=e.isLink,p=e.required,v=null!=(t=e.clickable)?t:f,m={center:r,required:p,clickable:v,borderless:!d};return o&&(m[o]=!!o),l("div",{class:Q(m),role:v?"button":void 0,tabindex:v?0:void 0,onClick:a},[n.icon?n.icon():e.icon?l(i,{name:e.icon,class:Q("left-icon"),classPrefix:e.iconPrefix},null):void 0,u(),s(),c(),null==n.extra?void 0:n.extra()])}}});function te(e,t){return(!t.required||!function(e){return Array.isArray(e)?!e.length:0!==e&&!e}(e))&&!(t.pattern&&!t.pattern.test(String(e)))}function ne(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!w(e)}var ae=o("field"),le=ae[0],oe=ae[1],re=le({props:a({},X,{rows:[Number,String],name:String,rules:Array,autosize:[Boolean,Object],leftIcon:String,rightIcon:String,clearable:Boolean,formatter:Function,maxlength:[Number,String],labelWidth:[Number,String],labelClass:null,labelAlign:String,inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,errorMessageAlign:String,showWordLimit:Boolean,type:{type:String,default:"text"},error:{type:Boolean,default:null},colon:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},modelValue:{type:[String,Number],default:""},clearTrigger:{type:String,default:"focus"},formatTrigger:{type:String,default:"onChange"}}),emits:["blur","focus","clear","keypress","click-input","click-left-icon","click-right-icon","update:modelValue"],setup:function(e,t){var n=t.emit,a=t.slots,o=u({focused:!1,validateFailed:!1,validateMessage:""}),w=s(),P=s(),B=_("vanForm").parent,z=function(t){return r(e[t])?e[t]:B&&r(B.props[t])?B.props[t]:void 0},M=c((function(){var t=z("readonly");if(e.clearable&&!t){var n=r(e.modelValue)&&""!==e.modelValue,a="always"===e.clearTrigger||"focus"===e.clearTrigger&&o.focused;return n&&a}})),O=c((function(){return P.value&&a.input?P.value():e.modelValue})),I=function(e,t){var n=t.message;return V(n)?n(e,t):n},j=function(e){return e.reduce((function(e,t){return e.then((function(){if(!o.validateFailed){var e=O.value;return t.formatter&&(e=t.formatter(e,t)),te(e,t)?t.validator?function(e,t){return new Promise((function(n){var a=t.validator(e,t);if(k(a))return a.then(n);n(a)}))}(e,t).then((function(n){n&&"string"==typeof n?(o.validateFailed=!0,o.validateMessage=n):!1===n&&(o.validateFailed=!0,o.validateMessage=I(e,t))})):void 0:(o.validateFailed=!0,void(o.validateMessage=I(e,t)))}}))}),Promise.resolve())},F=function(){o.validateFailed&&(o.validateFailed=!1,o.validateMessage="")},T=function(t){return void 0===t&&(t=e.rules),new Promise((function(n){t||n(),F(),j(t).then((function(){o.validateFailed?n({name:e.name,message:o.validateMessage}):n()}))}))},A=function(t){if(B&&e.rules){var n=B.props.validateTrigger===t,a=e.rules.filter((function(e){return e.trigger?e.trigger===t:n}));T(a)}},N=function(t,a){void 0===a&&(a="onChange"),t=r(t)?String(t):"";var l=e.maxlength,o=e.modelValue;if(r(l)&&t.length>l&&(t=o&&o.length===+l?o:t.slice(0,l)),"number"===e.type||"digit"===e.type){var i="number"===e.type;t=R(t,i,i)}e.formatter&&a===e.formatTrigger&&(t=e.formatter(t)),w.value&&t!==w.value.value&&(w.value.value=t),t!==e.modelValue&&n("update:modelValue",t)},W=function(e){e.target.composing||N(e.target.value)},q=function(){w.value&&w.value.blur()},D=function(e){o.focused=!0,n("focus",e),z("readonly")&&q()},L=function(t){o.focused=!1,N(e.modelValue,"onBlur"),n("blur",t),A("onBlur"),C()},E=function(e){n("click-input",e)},H=function(e){n("click-left-icon",e)},U=function(e){n("click-right-icon",e)},$=function(e){g(e),n("update:modelValue",""),n("clear",e)},G=c((function(){return"boolean"==typeof e.error?e.error:!!(B&&B.props.showError&&o.validateFailed)||void 0})),K=c((function(){var e=z("labelWidth");if(e)return{width:b(e)}})),Y=function(t){13===t.keyCode&&(z("submitOnEnter")||"textarea"===e.type||g(t),"search"===e.type&&q());n("keypress",t)},Z=function(e){e.target.composing=!0},J=function(e){var t=e.target;t.composing&&(t.composing=!1,S(t,"input"))},Q=function(){var t=w.value;if("textarea"===e.type&&e.autosize&&t){t.style.height="auto";var n=t.scrollHeight;if(h(e.autosize)){var a=e.autosize,l=a.maxHeight,o=a.minHeight;l&&(n=Math.min(n,l)),o&&(n=Math.max(n,o))}n&&(t.style.height=n+"px")}},X=function(){var t=z("disabled"),n=z("readonly"),o=z("inputAlign");if(a.input)return l("div",{class:oe("control",[o,"custom"]),onClick:E},[a.input()]);var r={ref:w,name:e.name,rows:e.rows,class:oe("control",o),value:e.modelValue,disabled:t,readonly:n,placeholder:e.placeholder,autocomplete:e.autocomplete,onBlur:L,onFocus:D,onInput:W,onClick:E,onChange:J,onKeypress:Y,onCompositionend:J,onCompositionstart:Z},i=e.type;if("textarea"===i)return l("textarea",r,null);var u,s=i;return"number"===i&&(s="text",u="decimal"),"digit"===i&&(s="tel",u="numeric"),l("input",y({type:s,inputmode:u},r),null)},ae=function(){var t=a["right-icon"];if(e.rightIcon||t)return l("div",{class:oe("right-icon"),onClick:U},[t?t():l(i,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},le=function(){if(e.showWordLimit&&e.maxlength){var t=(e.modelValue||"").length;return l("div",{class:oe("word-limit")},[l("span",{class:oe("word-num")},ne(t)?t:{default:function(){return[t]}}),x("/"),e.maxlength])}},re=function(){if(!B||!1!==B.props.showErrorMessage){var t=e.errorMessage||o.validateMessage;if(t){var n=z("errorMessageAlign");return l("div",{class:oe("error-message",n)},ne(t)?t:{default:function(){return[t]}})}}};return d({blur:q,focus:function(){w.value&&w.value.focus()},validate:T,formValue:O,resetValidation:F}),f("vanField",{childFieldValue:P,resetValidation:F,validateWithTrigger:A}),p((function(){return e.modelValue}),(function(e){N(e),F(),A("onChange"),m(Q)})),v((function(){N(e.modelValue,e.formatTrigger),m(Q)})),function(){var t,n,o=z("disabled"),r=z("labelAlign"),u=(n=z("colon")?":":"",a.label?[a.label(),n]:e.label?l("span",null,[e.label+n]):void 0),s=function(){var t=a["left-icon"];if(e.leftIcon||t)return l("div",{class:oe("left-icon"),onClick:H},[t?t():l(i,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])}();return l(ee,{size:e.size,icon:e.leftIcon,class:oe((t={error:G.value,disabled:o},t["label-"+r]=r,t["min-height"]="textarea"===e.type&&!e.autosize,t)),center:e.center,border:e.border,isLink:e.isLink,required:e.required,clickable:e.clickable,titleStyle:K.value,valueClass:oe("value"),titleClass:[oe("label",r),e.labelClass],arrowDirection:e.arrowDirection},{default:function(){return[l("div",{class:oe("body")},[X(),M.value&&l(i,{name:"clear",class:oe("clear"),onTouchstart:$},null),ae(),a.button&&l("div",{class:oe("button")},[a.button()])]),le(),re()]},icon:s?function(){return s}:null,title:u?function(){return u}:null,extra:a.extra})}}}),ie=o("dropdown-menu"),ue=ie[0],se=ie[1],ce=ue({props:{zIndex:[Number,String],activeColor:String,overlay:{type:Boolean,default:!0},duration:{type:[Number,String],default:.2},direction:{type:String,default:"down"},closeOnClickOutside:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}},setup:function(a,o){var i=o.slots,u=s(),d=s(0),f=s(),p=$("vanDropdownMenu"),v=p.children,m=p.linkChildren,g=P(u),b=c((function(){return v.some((function(e){return e.state.showWrapper}))})),h=c((function(){if(b.value&&r(a.zIndex))return{zIndex:1+a.zIndex}})),y=function(){if(f.value){var e=B(f);"down"===a.direction?d.value=e.bottom:d.value=window.innerHeight-e.top}},w=function(e,t){var n=e.state.showPopup,o=e.disabled,r=e.titleClass;return l("div",{role:"button",tabindex:o?-1:0,class:se("item",{disabled:o}),onClick:function(){var e;o||(e=t,v.forEach((function(t,n){n===e?(y(),t.toggle()):t.state.showPopup&&t.toggle(!1,{immediate:!0})})))}},[l("span",{class:[se("title",{down:n===("down"===a.direction),active:n}),r],style:{color:n?a.activeColor:""}},[l("div",{class:"van-ellipsis"},[e.renderTitle()])])])};return m({props:a,offset:d}),function(a,l,o){if(void 0===o&&(o={}),e){var r=o.eventName;t(void 0===r?"click":r,(function(e){var t=n(a);t&&!t.contains(e.target)&&l(e)}),{target:document})}}(u,(function(){a.closeOnClickOutside&&v.forEach((function(e){e.toggle(!1)}))})),t("scroll",(function(){b.value&&y()}),{target:g}),function(){return l("div",{ref:u,class:se()},[l("div",{ref:f,style:h.value,class:se("bar",{opened:b.value})},[v.map(w)]),null==i.default?void 0:i.default()])}}});var de=o("dropdown-item"),fe=de[0],pe=de[1],ve=fe({props:{title:String,disabled:Boolean,teleport:[String,Object],modelValue:null,titleClass:null,options:{type:Array,default:function(){return[]}},lazyRender:{type:Boolean,default:!0}},emits:["open","opened","close","closed","change","update:modelValue"],setup:function(e,t){var n=t.emit,a=t.slots,o=u({showPopup:!1,transition:!0,showWrapper:!1}),r=_("vanDropdownMenu").parent,s=function(e){return function(){return n(e)}},c=s("open"),f=s("close"),p=s("opened"),v=function(){o.showWrapper=!1,n("closed")},m=function(t){e.teleport&&t.stopPropagation()},g=function(t){var a=r.props.activeColor,u=t.value===e.modelValue;return l(ee,{clickable:!0,key:t.value,icon:t.icon,title:t.text,class:pe("option",{active:u}),style:{color:u?a:""},onClick:function(){o.showPopup=!1,t.value!==e.modelValue&&(n("update:modelValue",t.value),n("change",t.value))}},{default:function(){return[u&&l(i,{class:pe("icon"),color:a,name:"success"},null)]}})},b=function(){var t=r.offset,n=r.props,i=n.zIndex,u=n.overlay,s=n.duration,d=n.direction,b=n.closeOnClickOverlay,h={zIndex:i};return"down"===d?h.top=t.value+"px":h.bottom=t.value+"px",z(l("div",{style:h,class:pe([d]),onClick:m},[l(O,{show:o.showPopup,"onUpdate:show":function(e){return o.showPopup=e},class:pe("content"),overlay:u,position:"down"===d?"top":"bottom",duration:o.transition?s:0,lazyRender:e.lazyRender,overlayStyle:{position:"absolute"},closeOnClickOverlay:b,onOpen:c,onClose:f,onOpened:p,onClosed:v},{default:function(){return[e.options.map(g),null==a.default?void 0:a.default()]}})]),[[M,o.showWrapper]])};return d({state:o,toggle:function(e,t){void 0===e&&(e=!o.showPopup),void 0===t&&(t={}),e!==o.showPopup&&(o.showPopup=e,o.transition=!t.immediate,e&&(o.showWrapper=!0))},renderTitle:function(){if(a.title)return a.title();if(e.title)return e.title;var t=e.options.filter((function(t){return t.value===e.modelValue}));return t.length?t[0].text:""}}),function(){var t,n;return e.teleport?l(I,{to:e.teleport},"function"==typeof(n=t=b())||"[object Object]"===Object.prototype.toString.call(n)&&!w(n)?t:{default:function(){return[t]}}):b()}}});var me=F({name:"AddPage",components:{[ce.name]:ce,[ve.name]:ve,[re.name]:re,NavHeader:T},setup(){const e=A(),t=N(),n=u({tab:"dev",options:[{text:"测试",value:"dev"},{text:"分享",value:"share"},{text:"问答",value:"ask"},{text:"招聘",value:"job"}],title:"",content:""});return{topic:n,submit:async()=>{if(!n.title)return void Y("标题不能为空");if(!n.content)return void Y("内容不能为空");const a={accesstoken:e.state.user.userInfo.token,title:n.title,tab:n.tab,content:n.content};try{(await function(e){return j.post("/topics",e)}(a)).success&&(Y("发布成功"),t.replace(`/list?tab=${n.tab}`))}catch(l){Y("发布失败")}}}}});const ge=U("data-v-493e6f2c");W("data-v-493e6f2c");const be={class:"d-flex align-items-center van-hairline--bottom add-hd"},he=l("span",null,"选择分类：",-1),ye={class:"flex-1"},we={class:"add-title van-hairline--bottom"},xe={class:"add-content"};q();const ke=ge(((e,t,n,a,o,r)=>{const i=D("nav-header"),u=D("van-dropdown-item"),s=D("van-dropdown-menu"),c=D("van-field");return L(),E(H,null,[l(i,{title:"主题"}),l("div",be,[he,l("div",ye,[l(s,null,{default:ge((()=>[l(u,{modelValue:e.topic.tab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.topic.tab=t),options:e.topic.options},null,8,["modelValue","options"])])),_:1})]),l("div",{class:"submit-btn",onClick:t[2]||(t[2]=(...t)=>e.submit&&e.submit(...t))},"发布")]),l("div",we,[l(c,{modelValue:e.topic.title,"onUpdate:modelValue":t[3]||(t[3]=t=>e.topic.title=t),modelModifiers:{trim:!0},clearable:"",maxlength:"100",placeholder:"标题，字数10字以上"},null,8,["modelValue"])]),l("div",xe,[l(c,{modelValue:e.topic.content,"onUpdate:modelValue":t[4]||(t[4]=t=>e.topic.content=t),rows:"20",type:"textarea",placeholder:"回复支持Markdown语法,请注意标记代码"},null,8,["modelValue"])])],64)}));me.render=ke,me.__scopeId="data-v-493e6f2c";export default me;
